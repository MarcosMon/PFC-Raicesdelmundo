<app-navigation></app-navigation>
<div *ngIf="userID != '2'">
<div class="container p-4">
  <section class="content">
    <div class="row">
      <div class="col-md-3">
        <div class="grid support">
          <div class="grid-body">
            <h2>Browse</h2>

            <hr />

            <ul>
              <li class="active">
                <a  href="#">All my Tickets<span class="pull-right">{{
                    this.commentList.length
                  }}</span></a>
              </li>
              <li>
                <a href="#">Open Tickets<span class="pull-right">{{
                    this.countStatus.Open || 0
                  }}</span></a>
              </li>
              <li>
                <a href="#">Closed Tickets<span class="pull-right">{{
                    this.countStatus.Closed || 0
                  }}</span></a>
              </li>
            </ul>

            <hr />

            <p><strong>Labels</strong></p>
            <ul class="support-label">
              <li>
                <p ><span class="bg-blue">&nbsp;</span>&nbsp;&nbsp;&nbsp;Page
                  Issues<span class="pull-right">{{
                    this.countType.Issue || 0
                  }}</span></p>
              </li>
              <li>
                <p><span class="bg-red">&nbsp;</span>&nbsp;&nbsp;&nbsp;Request
                  for permissions<span class="pull-right">{{
                    this.countType.Permissions || 0
                  }}</span></p>
              </li>
              <li>
                <p  ><span class="bg-yellow">&nbsp;</span>&nbsp;&nbsp;&nbsp;suggestions<span class="pull-right">{{
                    this.countType.Suggestions || 0
                  }}</span></p>
              </li>
            </ul>
          </div>
        </div>
      </div>

      <div class="col-md-9">
        <div class="grid support-content">
          <div class="grid-body">
            <h2>Tickets</h2>

            <hr />

            <div class="btn-group"></div>

            <button type="button" class="btn btn-success pull-right align-center" data-toggle="modal"
              data-target="#newIssue">
              New Ticket
            </button>
            <div class="modal fade" id="newIssue" tabindex="-1" role="dialog" aria-labelledby="newIssue"
              aria-hidden="true">
              <div class="modal-wrapper">
                <div class="modal-dialog">
                  <div class="modal-content">
                    <div class="modal-header bg-blue">
                      <h4 class="modal-title">
                        <i class="fa fa-pencil"></i> Create New Ticket
                      </h4>
                      <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                        ×
                      </button>
                    </div>
                    <form action="#" method="post">
                      <div class="modal-body">
                        <div class="form-group">
                          <input name="subject" type="text" class="form-control" [(ngModel)]="this.subject"
                            placeholder="Subject" />
                        </div>
                        <div class="form-group">
                          <select id="" name="type" class="form-control" [(ngModel)]="this.type" required>
                            <option value="" selected disabled>Please select</option>
                            <option [ngValue]="'Issue'">Issue</option>
                            <option [ngValue]="'Permissions'">Request Permissions</option>
                            <option [ngValue]="'Suggestions'">Suggestions</option>
                          </select>
                        </div>
                        <div class="form-group">
                          <textarea name="message" class="form-control" [(ngModel)]="this.comment"
                            placeholder="Please detail your issue or question" style="height: 180px;"></textarea>
                        </div>
                      </div>
                      <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">
                          <i class="fa fa-times"></i> Discard
                        </button>
                        <button type="submit" class="close" data-dismiss="modal" aria-hidden="true"
                          (click)="createTicket()" class="btn btn-primary pull-right">
                          <i class="fa fa-pencil"></i> Create
                        </button>
                      </div>
                    </form>
                  </div>
                </div>
              </div>
            </div>
            <div class="padding"></div>

            <div class="row">
              <div class="col-md-12">
                <ul class="list-group fa-padding">
                  <li class="list-group-item" *ngFor="let comment of commentList; let i = index"
                    (click)="setSelectedRow(comment, i)" data-toggle="modal" data-target="#issue">
                    <div class="media">
                      <i class="fa fa-cog pull-left"></i>
                      <div class="media-body">
                        <strong>{{ comment.subject }}</strong><span class="number pull-right">{{comment.status  }}
                          #00{{ i }}</span>
                        <p class="info">
                          Opened by {{ comment.username }}
                          {{ comment.created_at | date: "dd/MM/yy hh:mm a" }}
                        </p>
                      </div>
                    </div>
                  </li>
                </ul>

                <div class="modal fade" id="issue" tabindex="-1" role="dialog" aria-labelledby="issue"
                  aria-hidden="true">
                  <div class="modal-wrapper">
                    <div class="modal-dialog">
                      <div class="modal-content">
                        <div class="modal-header bg-blue">
                          <h4 class="modal-title">
                            {{ this.selectedRow.type }}/
                            {{ this.selectedRow.status }}
                          </h4>

                          <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                            ×
                          </button>
                        </div>

                        <form action="#" method="post">
                          <div class="modal-body">
                            <div class="row">
                              <div class="col-md-2">
                                <img src="assets/img/user/avatar01.png" class="img-circle" alt="" width="50" />
                              </div>
                              <div class="col-md-10">
                                <p>
                                  {{ this.selectedRow.subject }}
                                  <strong>#00{{ this.ticketCount }}</strong>
                                  opened by
                                  <a href="#">{{ this.selectedRow.username }} </a>{{
                                    this.selectedRow.created_at
                                      | date: "dd/MM/yy hh:mm a"
                                  }}
                                </p>
                                <p>{{ this.selectedRow.comment }}</p>
                              </div>
                            </div>
                          </div>
                          <div class="modal-footer">
                            <button type="button" class="btn btn-default" data-dismiss="modal">
                              <i class="fa fa-times"></i> Close
                            </button>
                          </div>
                        </form>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
</div>
</div>


<div *ngIf="userID == '2'">
  <div class="container p-4">
    <section class="content">
      <div class="row">
        <div class="col-md-3">
          <div class="grid support">
            <div class="grid-body">
              <h2>Browse</h2>

              <hr />

              <ul>
                <li class="active">
                  <a href="#">All my Tickets<span class="pull-right">{{
                      this.allTicketList.length
                    }}</span></a>
                </li>
                <li>
                  <a href="#">Open Tickets<span class="pull-right">{{
                      this.countStatus.Open || 0
                    }}</span></a>
                </li>
                <li>
                  <a href="#">Closed Tickets<span class="pull-right">{{
                      this.countStatus.Closed || 0
                    }}</span></a>
                </li>
              </ul>

              <hr />

              <p><strong>Labels</strong></p>
              <ul class="support-label">
                <li>
                  <a href="#"><span class="bg-blue">&nbsp;</span>&nbsp;&nbsp;&nbsp;Page
                    Issues<span class="pull-right">{{
                      this.countType.Issue || 0
                    }}</span></a>
                </li>
                <li>
                  <a href="#"><span class="bg-red">&nbsp;</span>&nbsp;&nbsp;&nbsp;Request
                    for permissions<span class="pull-right">{{
                      this.countType.Permissions || 0
                    }}</span></a>
                </li>
                <li>
                  <a href="#"><span class="bg-yellow">&nbsp;</span>&nbsp;&nbsp;&nbsp;suggestions<span class="pull-right">{{
                      this.countType.Suggestions || 0
                    }}</span></a>
                </li>
              </ul>
            </div>
          </div>
        </div>

        <div class="col-md-9">
          <div class="grid support-content">
            <div class="grid-body">
              <h2>Tickets</h2>

              <hr />

              <div class="btn-group"></div>

              <button type="button" class="btn btn-success pull-right align-center" data-toggle="modal"
                data-target="#newIssue">
                New Ticket
              </button>
              <div class="modal fade" id="newIssue" tabindex="-1" role="dialog" aria-labelledby="newIssue"
                aria-hidden="true">
                <div class="modal-wrapper">
                  <div class="modal-dialog">
                    <div class="modal-content">
                      <div class="modal-header bg-blue">
                        <h4 class="modal-title">
                          <i class="fa fa-pencil"></i> Create New Ticket
                        </h4>
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                          ×
                        </button>
                      </div>
                      <form action="#" method="post">
                        <div class="modal-body">
                          <div class="form-group">
                            <input name="subject" type="text" class="form-control" [(ngModel)]="this.subject"
                              placeholder="Subject" />
                          </div>
                          <div class="form-group">
                            <select id="inputState" name="type" class="form-control" [(ngModel)]="this.type">
                              <option value="" hidden>Please Choose...</option>
                              <option [ngValue]="'Issue'">Issue</option>
                              <option [ngValue]="'Permissions'">Request Permissions</option>
                              <option [ngValue]="'Suggestions'">Suggestions</option>
                            </select>
                          </div>
                          <div class="form-group">
                            <textarea name="message" class="form-control" [(ngModel)]="this.comment"
                              placeholder="Please detail your issue or question" style="height: 180px;"></textarea>
                          </div>
                        </div>
                        <div class="modal-footer">
                          <button type="button" class="btn btn-default" data-dismiss="modal">
                            <i class="fa fa-times"></i> Discard
                          </button>
                          <button type="submit" class="close" data-dismiss="modal" aria-hidden="true"
                            (click)="createTicket()" class="btn btn-primary pull-right">
                            <i class="fa fa-pencil"></i> Create
                          </button>
                        </div>
                      </form>
                    </div>
                  </div>
                </div>
              </div>
              <div class="padding"></div>

              <div class="row">
                <div class="col-md-12">
                  <ul class="list-group fa-padding">
                    <li class="list-group-item" *ngFor="let comment of allTicketList; let i = index"
                      (click)="setSelectedRow(comment, i)" data-toggle="modal" data-target="#issue">
                      <div class="media">
                        <i class="fa fa-cog pull-left"></i>
                        <div class="media-body">
                          <strong>{{ comment.subject }}</strong><span class="number pull-right">{{comment.status  }}
                            #00{{ i }}</span>
                          <p class="info">
                            Opened by {{ comment.username }}
                            {{ comment.created_at | date: "dd/MM/yy hh:mm a" }}
                          </p>
                        </div>
                      </div>
                    </li>
                  </ul>

                  <div class="modal fade" id="issue" tabindex="-1" role="dialog" aria-labelledby="issue"
                    aria-hidden="true">
                    <div class="modal-wrapper">
                      <div class="modal-dialog">
                        <div class="modal-content">
                          <div class="modal-header bg-blue">
                            <h4 class="modal-title">
                              {{ this.selectedRow.type }}/
                              {{ this.selectedRow.status }}
                            </h4>

                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                              ×
                            </button>
                          </div>

                          <form action="#" method="post">
                            <div class="modal-body">
                              <div class="row">
                                <div class="col-md-2">
                                  <img src="assets/img/user/avatar01.png" class="img-circle" alt="" width="50" />
                                </div>
                                <div class="col-md-10">
                                  <p>
                                    {{ this.selectedRow.subject }}
                                    <strong>#00{{ this.ticketCount }}</strong>
                                    opened by
                                    <a href="#">{{ this.selectedRow.username }} </a>{{
                                      this.selectedRow.created_at
                                        | date: "dd/MM/yy hh:mm a"
                                    }}
                                  </p>
                                  <p>{{ this.selectedRow.comment }}</p>
                                </div>
                              </div>
                            </div>
                            <div class="modal-footer">
                              <button type="button" (click)="
                                  updateTicketStatus(
                                    this.selectedRow.id,
                                    'Closed',this.selectedRow.id_user
                                  )
                                " class="btn btn-default" data-dismiss="modal">
                                <i class="fa fa-times"></i> Cerrar Ticket
                              </button>

                              <button type="button" class="btn btn-default" data-dismiss="modal">
                                <i class="fa fa-times"></i> Close
                              </button>
                            </div>
                          </form>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </div>
  </div>

